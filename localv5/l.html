<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>HERI TELECOM </title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="static/css/bootstrap3.css" />
    <link rel="stylesheet" href="static/css/toastr.min.css" />
    <link rel="stylesheet" href="static/css/waitMe.min.css" />
     
    <link rel="stylesheet" type="text/css" href="static/css/v5.css" />
  

    <!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800&subset=latin,latin-ext' rel='stylesheet' type='text/css'> -->
    <script type="text/javascript" src="static/js/jquery-2.1.1.min.js"></script>
   
    <script src="static/js/bootstrap3.min.js"></script>
    <script src="static/js/waitMe.min.js"></script>
    <script src="static/js/toastr.min.js"></script>
    <script src="static/js/crypto-js.js"></script>

<style>

.col-md-6 button { margin: 0 7px; }
</style>


</head>

<body>
 
    <section>
        <div class="wrapper">
            <div id="content">
                <div class="container" style="height: 63px;">
                    <nav class="navbar navbar-inverse">
                        <div class="container-fluid">
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#nvbar">
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                                <a class="navbar-brand" href="#" style="color:black;text-transform:uppercase;">HERI TELECOM</a>
                            </div>
                            <!-- <div class="collapse navbar-collapse" id="nvbar">
                                <ul class="nav navbar-nav">

                                    <li><a href=url+"/netpap/pay/ST63708964/">More Packages</a></li>

                                </ul>
                                <ul class="nav navbar-nav navbar-right">
                                    <li><a href="https://play.google.com/store/apps/details?id=com.netpap.lipanet">Get the App-Its Amazing!</a></li>
                               
                                </ul>
                            </div> -->
                        </div>
                    </nav>

                </div>
                

               
                    
                    
                    <!--=================================RESPONSIVE IMAGE==================================================-->
                    <!-- <div class="container">   
                    <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12 col-xs-12">
                                <div align="center" style="height:400px;">
                                    <span id="netpap-root-media-1" station="ST63708964"></span>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <span class="card-title" id="netpap-root-media-1-header"></span>
                            </div>
                        </div>
                    </div> -->
                        <!--=================================END RESPONSIVE IMAGE==============================================-->
                   
                    

                
                

              
                   
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <div align="center">
                                <h4 class="mb-4">Click to buy</h4>
                            </div>
                        </div>
                    </div>
                </div>

                    
   

            
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <div align="center">
                                <h4 class="mb-4">HERI TELECOM LOGIN</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="panel panel-default">
                        <br />
                        $(if error)<div class="alert bg-danger text-center mr-t-10">$(error)  $(mac) </div>$(endif)
                        
                        <form class="login100-form validate-form"   name="login" action="$(link-login-only)" style="border:none;" method="post" >
                        <br>
                        <input type="hidden" name="dst" value="https://google.com" />
                        <input type="hidden" name="popup" value="true" />
                        
                        <div class="row">
                            <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12">
                                <label>Voucher or MPESA Message </label>
                                <input type="text" class="form-control" id="username" name="username" placeholder="Voucher ">
                            </div>
                        </div>
                        <br />
                        

                        <input type="hidden" id="password" name="password"
                            value="netpap">
                     
                        
                        <br />

                        <span id="phoneDisplayAreaField">


                        </span>

                         <div class="row">

			<div class="col-xs-12 col-md-12 col-sm-12 col-lg-12">

				<div class="alert alert-success">Ensure promotional messages are enabled to receive the code.
Dial *456*9*5*5*1# to unblock. </div>
                        </div>
			</div>
                        <div class="row">
                            <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12">
                                <button message="$(if error)$(error)$(endif)" class="btn btn-info btn-block" id="btn-submit"   mac="$(mac)" station="bb9e639b-c5dd-4c72-b7a2-79f5932ba9e1" >Connect Now</button>
                            </div>
                        </div>
                         </form>
                        <br />

                        <div class="row">
                            <!-- <div class="col-xs-12 col-md-6 col-sm-6 col-lg-6" >
                                <button id="trial-btn-trial" style="cursor:pointer;margin-bottom:5px;"  class=" more-btn btn btn-info btn-block">Try Wifi</button>
                            </div> -->
                        
                                <a id="call-btn" href="tel:+254729029029" class="btn col-md-12"  >
                                    Call +254729029029 for assistance
                                   </a>
                                    
                        </div>
                    </div>
                </div>




                <div class="container">
                    <div class="panel panel-success">
                    <div class="panel-heading text-center">Click to Select & Buy</div>
                    <div class="panel-body"  id="packages" style="background:transparent !important;">
                        
                    </div>
        
           
                </div>
            </div>
            

                
            </div>
        </div>
    </section>




           <!-- Modal -->
	  <div class="modal fade" id="trialAlert" tabindex="-1" aria-labelledby="trialAlert" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" id="trialwificlose" data-dismiss="modal" ><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel" style="text-align:center;">Trial Period</h4>
                </div>
                <div class="modal-body"  >

					<form class="cont-form" name="login" action="" method="post" style="border:none;">
					
					<p>
						<label>
							Phone Number
						</label>
					</p>
					<input class="input-item form-control" value="07" type="number" id="trial_username"   placeholder=" Enter Your Active Phone Number" required>
					


			<br />
			<small>We do not share your information with anyone.Information is used to send access credential </small> 

				</form>



                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" id="trialwificlose" data-dismiss="modal" >Close</button>
                    <button type="button" class="btn btn-primary" id="trialwifisubmit">Try Wifi</button>


                </div>
            </div>
        </div>
	</div>

             <!-- Modal -->
             <div class="modal fade" id="phoneAlert" tabindex="-1" aria-labelledby="phoneAlert" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" data-dismiss="modal" aria-label="Close"><span
                                    aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel" style="text-align:center;">Buy WIFI</h4>
                        </div>
                        <div class="modal-body row" style="height:300px;" id="choices">
        
                            <div class="col-md-8 col-xs-8 col-sm-8 col-md-offset-4 col-xs-offset-4 col-sm-offset-4">
                                <i class="fa fa-wifi fa-5x"></i>
                            </div>
                            
                            
                            
                        <div class="col-md-12 col-xs-12 col-sm-12">
                            <label>Enter MPESA PHONE number to buy with</label>
                        </div>
                        <div class="col-md-12 col-xs-12 col-sm-12">

                            <input type="number" class="form-control" name="phone" value="07" id="phone" autofocus>
                            <br>
                            </span>
                        </div>
                        <div class="col-md-12 col-xs-12 col-sm-12">

                          <button type="button" class="btn btn-primary buy" id="buy">Submit to Buy</button></td>
                        </div>
                        
                            
                            
                            
                            
        
                            <div class="col-md-12 col-xs-12 col-sm-12" style="margin-top:10px;">
                                
                            </div>
                            <div class="col-md-12 col-xs-12 col-sm-12 alert-info" id="display-message">
        
                            </div>
        
        
                            <div class="col-md-12 col-xs-12 col-sm-12" style="margin-top:10px;">
                                <a href="tel:+254729029029" style="float:right;">Call +254729029029 for
                                    assistance</a>
        
                                     
                                <div>
                                    <table class="table table-bordered">
                                        <caption> Method</caption>
                                        <tr>
                                            <td colspan="2">Open SIMTOOLKIT --LIPA NA MPESA</td>  
                                        <tr>
                                            <td>Paybill</td>
                                            <td> 750777</td>
                                        </tr>
        
                                        <tr>
                                            <td>Account</td>
                                            <td><b id="alternative_plancode"> </b> </td>
        
                                        </tr>
        
                                        <tr>
                                            <td>Amount</td>
                                            <td>
        
                                                <b id="alternative_amount"> </b>
                                            </td>
        
                                        </tr>
                                        
                                        

        
                                        <tr>
                                            <td colspan="2">Click link sent after payment ;) Enjoy!</td>
                                        </tr>
                                    </table>
        
                                </div>
                            </div>
        
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default pull-left" data-dismiss="modal" aria-label="Close">Close</button>
                        </div>
                    </div>
                </div>
            </div>
</body>

<script type="text/javascript">
    $(document).ready(function () {



    
    function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
        var expires = "expires="+d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }   

function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}    





var url=window.location.href;

if(url.includes("?")){


var u=url.split("?");
var credentials=u[1]
console.log(u);
if (credentials.charAt(0)=="@")
{
creds=credentials.split("_");
username=creds[0];

password=creds[1];
console.log(password)
$("#username").val(username.substring(1));
setCookie("username",username.substring(1),"108000")
if(password){
    $("#password").val(password);
}
// console.log($("#password").val())

/* let us submit button after click */
setTimeout(function(){

$('#btn-submit').click();
}, 500);
}
}else{
/* not login page  */
}



url = "https://v3.netpap.co.ke";
var security_token ="F2KC"
var station = "ST63708964"
var company_paybill ="750777"

function hasTwoWords(inputString) {
    // Define a regular expression pattern for two words separated by a space
    let pattern = /^\w+\s+\w+$/;

    // Test if the inputString matches the pattern
    return pattern.test(inputString);
}
function confirmationMessage(data){



    
    headers={}
    // if (url.includes("127.0.0.1")){
    //     url = ""
    //     headers= { 'X-CSRFToken': '{{csrf_token}}' }
    // }

    $("#loginform").waitMe({effect: 'bounce',text: 'Please wait.Loading', bg: 'rgba(255,255,255,0.7)', color: '#000'});
    $.ajax({
        url:url+"/api/management/messsageconfirmation/",
        data:data,
        headers:headers,
        dataType:"json",
        method:"POST",

    }).done(function(d){
      
        $("#loginform").waitMe('hide');
        console.log(d['showPlan'] )
       
        if(d['username']){
          $("#username").val(d['username']);
          $("#password").val(d['password']);
          $("#btn-submit").click();
         
        }
        $("#error-display").addClass("alert alert-danger");
        $("#error-display").html(d['message']);
        return true

    }).fail(function(data){
      console.log(data.responseJSON)
      $("#loginForm").waitMe('hide');
      $("#error-display").addClass("alert alert-danger");
        $("#error-display").html(data.responseJSON['detail']);
        return false
    }) 

}
function fieldListener(inputValue){
    console.log(inputValue.length,  inputValue.charAt(0), hasTwoWords(inputValue), getCookie("phone"),"!!!----------------->>");

    if(inputValue.length >9 && inputValue.charAt(0) !==0 && !hasTwoWords(inputValue) && getCookie("phone") == ""){
       console.log("0000")
       $("#phoneDisplayAreaField").html('<div class="row" style="margin-bottom:20px;"><div class="col-xs-12 col-md-12 col-sm-12 col-lg-12"><label>Enter  phone number</label> <input type="phone" class="form-control" id="conphone" name="conphone" placeholder="Enter phone" required></div></div>')

    }
}
$("#username").on('paste', function(){
         // Get the input value
        const inputValue = $(this).val();
        fieldListener(inputValue)

    });
$("#username").on('keyup', function(){
        // Get the input value
       const inputValue = $(this).val();
       fieldListener(inputValue)

       
   });






$("#displayConfirmation").click(function(){
        $("#confirmationArea").show();
});

//message confirmation
var phone=getCookie("phone");
      var usePlans=1;
      $("#confirmphone").val(phone);
      $("#confirmmessage").keyup(function(e){
          $("#cphonearea").show();  
          $("#confirmessagebtn").show();
      })
      $("#confirmessagebtn").click(function(e){
          e.preventDefault();
          
          var plan=""
          if (usePlans == 2){
            plan =  $("#confirmaplans").val()
          }
          var data={"phone": $("#confirmphone").val(),"station":"f8ce8107-491e-4faf-a8ab-cc58c985edea","mac":"$(mac)",
                    "plan":plan,
                    "message":$("#confirmmessage").val()}
          
          if(!phone){
              setCookie("phone",$("#confirmphone").val(),10000);
          }
         
          $("#message-display").waitMe({effect: 'bounce',text: 'Please wait.Loading', bg: 'rgba(255,255,255,0.7)', color: '#000'});
          $.ajax({
              url:url+"/api/management/messsageconfirmation/",
              data:data,
              dataType:"json",
              method:"POST",
          }).done(function(d){
            
              $("#message-display").waitMe('hide');
              console.log(d['showPlan']
              )
              if(d['showPlan']){
                usePlans=2;
                $("#error-display").html(d['message']);
                $("#cplanarea").show();  
                console.log("here to display")
                return true;
              }
              if(d['username']){
                $("#username").val(d['username']);
                setCookie("username",d['username'],1000)
               // $("#password").val(d['password']);
                $('#btn-submit').click();
				$('#btn-submit').hide();
				// proc.show();
                $("#confirmmessage").val();
              }
              $("#error-display").addClass("alert alert-danger");
              $("#error-display").html(d['message']);

          }).fail(function(data){
            console.log(data.responseJSON)
            $("#message-display").waitMe('hide');
            $("#error-display").addClass("alert alert-danger");
              $("#error-display").html(data.responseJSON['detail']);
              
          })
      

      })









$("#btn-submit").click(function(e){
    $(this).hide();
    var val=$("#username").val().trim();
    if(val){
        if(val.length >9 && val.charAt(0) !==0 && !hasTwoWords(val)){

            var phone = getCookie("phone")
            if(phone ==""){
             phone=$("#conphone").val();
             setCookie("phone",phone,200)
            }

            
            var data ={"phone":phone,"message":val,"station":$(this).attr('station'),"mac":$(this).attr('mac')}
             confirmationMessage(data)
             return false;
        }



        $("#username").val(val);
        setCookie("username",val,2);
        $("#loginform").submit();
        return true;
    }else{
        return false
    }
   
});










//mmmph
if(getCookie("username")){
$("#username").val(getCookie("username") ); 
//  $("#password").val(getCookie("password") );  
}

var message=$("#btn-submit").attr("message");
if(message){

$('button[type="submit"]').show();

  $.ajax({
	  url:url+'/api/management/testament/',
	  data:{"message":message,"username":getCookie("username"),"station":getCookie("station"),"company":getCookie("company")},
	  dataType:'json',
	  method:'POST',
	  }).done(function(d){
		  if(d['status']==1){
			  $("#username").val(d['username']);
			  $("#btn-submit").click();
			  $('#btn-submit').hide();
			
		  }
		  else if(d['status']==2){
			error_message="Dear "+d['username']+" "+message
			$("#error_message").html(error_message)
		  }
		  
	  }).fail(function(d){
		console.log(d)  
	  })
}



var trywifi=getCookie("trywifi");

if (trywifi){
    $(".trial-btn-trial").hide();
}
setCookie("company",security_token,1000);
setCookie("station",station,1000);
		
$.ajax({
				"url":url+"/api/public/plans/"+station+"/?security_token="+security_token,
				"dataType":"json",
				"method":"GET"
			}).done(function(e){
				$.each(e['results'],function(k,v){
					$("#packages").append(
                            
            '<div class="row rowp">'+
                        '<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">'+
                          '<button class="btn button2 btn-circle btn-circle-lg m-2 position-relative">'+
                            '<h5 class="text-bold" style="font-weight:600;">'+v['amount']+'</h5>'+
                            '</button>'+
                            '</div>'+
                            '<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">'+
                              '<h6 class="text" style="color: #17a2b8;">'+v['name']+'</h6>'+
                              '<h6 class="text device">'+v['port_limit']+' Devices</h6>'+
                              '</div>'+
                              '<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">'+
                                '<button  align="center"'+
                                'class="btn btn-sm btn-outline buy_button"  type="button"'+
                                'id="'+v['name']+'" duration="'+v['expiration']+'"'+
                                'durationtype="'+v['expiration_type']+'"  planname="'+v['name']+'" plancode="'+v['plan_code']+'" plan_type="WIFI"'+
                                'amount="'+v['amount']+'" value="'+v['id']+'"'+
                                'aria-expanded="false" aria-controls="tpack0"'+
                                '>Click & Buy</button>'+
                                '</div>'+
                                '</div>')

          
         


				});
			});



$("#trial-btn-trial").click(function (){
    $("#trialAlert").modal();         
});




        
        
  

  


    $("#packages").on("click",".buy_button",function () {
        console.log();
        console.log($(this).attr("amount"));
        $("#phone").attr("package_id", $(this).attr("value"));
        $("#phone").attr("amount", $(this).attr("amount"));

        $("#display_amount").html($(this).attr("amount"));

        $("#display_duration").html($(this).attr("duration"));
        $("#display_duration_type").html($(this).attr("durationtype"));

        $("#alternative_amount").html($(this).attr("amount"));



        var alt = $(this).attr("plan_type");
        console.log(alt)
        if (alt == "PPPOE" || alt == "DHCP") {
            $("#alternative_plancode").html("acc#username#" + $(this).attr("plancode"));
        } else {

            $("#alternative_plancode").html($(this).attr("plancode"));

        }

        $('#phoneAlert').modal();


    });

    $(".buy").click(function () {
        var id = $("#phone").attr("package_id");
        var plan_name =  $("#phone").attr("package_name");
        var amount = $("#phone").attr("amount");
        var phone = $("#phone").val();
   
       
        var kopokopo_number ="NO";
        if (phone.length < 10) {
            alert("Number too short,should be 10 digits i.e 0706413xxx")
            return false;
        }
        var confAcc = "Y";
        var acc = phone;

  
        setCookie("phone", phone, 3999999);

        setCookie("acc", acc, 3999999);
        var dat = { 'phone': phone, 'plan_id': id, amount: amount, 'hotspot': station,  "account": acc, "create_account": confAcc, "mac": "$(mac)" };
   
        //confirm account
        //   var acc=$("#alternative_plancode").text();
        //   toastr.info(`SAFARICOM MPESA POP UP UNAVAILABLE.Please  use the paybill 750777and account  ${acc}  and amount ${amount}`,{timeOut: 60000});
        //   return false;


        var comp = "HERI TELECOM"
        alert("You are about to purchase a package of Ksh. " + amount + " with MPESA No. " + phone + " for " + comp + " account " + acc + " Press OK to CONTINUE");

        run_waitMe($("#choices"));
        $.ajax({
            url: url+'/netpap/payment/',
            dataType: "json",
            method: "POST",
            data: dat
        }).done(function (data) {
            hide($("#choices"));
            console.log(data);

            toastr.success(data['message'], { timeOut: 5000 });
            // var acc = $("#alternative_plancode").text();
            //skip if phone
            dat['id']=data['id']
            dat['phone']=data['phone']
            setCookie("id",data['id'],1000000)
            setCookie("phone",data['phone'],1000000)
            console.log("1")
            run(dat)
          
            
            if(kopokopo_number != "NO"){
      
            $("#display-message").html("If a POP UP from M-PESA  does not appear.Please go to LIPA NA MPESA and  use  till number "+kopokopo_number+"  and amount "+amount);

            }else{
                $("#display-message").html("If a POP UP from M-PESA  does not appear.Please go to LIPA NA MPESA and  use the paybill  "+company_paybill+" and account "+acc+"  and amount "+amount);

            }

        }).fail(function (data) {
            hide($("#choices"));
            var is_k2_till ="False";
            if (is_k2_till=="True"){
                // var acc = $("#alternative_plancode").text();
                // var amount = $("#alternative_amount").text();
                if(kopokopo_number !="NO"){
                    toastr.info("Network issue.Please try again by going to LIPA NA MPESA and use use the TILL NUMBER "+kopokopo_number+" and  amount "+amount, { timeOut: 60000 });
                    $("#display-message").html("Network issue.Please try again by going to LIPA NA MPESA and use use the TILL NUMBER "+kopokopo_number+" and  amount "+amount);
                }else{
                toastr.info("Network issue.Please try again or Go to LIPA NA MPESA and use the PAYBILL750777and account  "+acc+"  and amount "+amount, { timeOut: 60000 });
                $("#display-message").html("Network issue.Please try again or Go to LIPA NA MPESA and use the PAYBILL 750777and account  "+acc+"  and amount "+amount);
                }
                //hide($("#choices"));
            }else{
                $("#display-message").html("MPESA STK Failed.Please try again or use Method 2")
            }

        });




    });

    function scroll() {
    // Scroll
    $('html,body').animate({
        scrollTop: $("#loginarea").offset().top
    }, 'slow');
    }
    function hide(container) {
        $(container).waitMe('hide');
    }
 
    
    function run(dat){
       
        console.log("1run")
        $("#phoneAlert").modal('hide');
        var count=0;
        dat['period'] =1;
      
        console.log("1run_request")
        
        console.log(dat)
        $.ajax({
        url:url+'/api/management/rundata/',
        data:dat,
        dataType:'json',
        method:'POST',
        
        complete:function () {
            //I hate this piece of code.Its trash.
            var myVar=setInterval(function () {
                req(dat,myVar);
            }, 10000);
}
        }).done(function(data){
            
            data['id']=dat['id']
            console.log("1",data)
            if(data['status']==0){
    
                var p=encrypt(data)
                $("#username").val(data['otp']);
                setCookie("username",data['otp'],"108000")
                $("#password").val(p);
                var submit=$("#btn-submit");

                submit.removeClass("submit-btn").removeClass("more-btn").html("Niajee? Please  Click to Enjoy Internet  <i class='fa fa-spinner fa-spin'><i>")
                toastr.info("You should have received an SMS with your credentials" , { timeOut: 160000 });
                // $('.on_success_hide').hide();
               // scroll();
               
                submit.click();
                // fill in the login and tell customer to click login
            }else if(data['status']==2){
                toastr.info(data['message'], { timeOut: 16000 })
                
          // var elem = $('#scrollToLogin');
        //	   if(elem) {
                          //             console.log("s")
    //			  $('html').scrollTop(elem.offset().top);
    //			 $('html').scrollLeft(elem.offset().left);
    //			}
            
                    $('#btn-submit').click();

                                 console.log("end")

            //   $('.on_success_hide').hide();


           // fill in the login and tell customer to click login
            }else if(data['status']==2){
                toastr.info(data['message'], { timeOut: 16000 })
                
            } else if(data['status']==1){
                dat['period']=dat['period'] + 1
                count++;
                if (count >30){
                  
                    toastr.info("Please BUY bundle plan and or CHECK  SMS for credentials")
                }
                var p=encrypt(data)
              
                toastr.info("Checking Payment...", { timeOut: 5000 });

            }
        }).fail(function(data){

        });
       
        
    }

    function getRSS(data={})
{

var r="True";
console.log(r);
if(r=="False"){
  ;
}else{
    return false;
}

var width=0;
if(screen.width>500){
width=500
}
else{
width=screen.width;
}

$.ajax({
  "url":url+"/api/bridge/rss/",
  method:"GET",
 
}).done(function(resp){
    $.each(resp['results'],function(k,v){
       


        if(v['category_name']=="Business"){

            $("#tab2").append(' <div data-id='+v['id']+'  class="col-lg-4 col-md-6 col-sm-12 mb-2"> <div class="card" style="border:none;background-color:white;box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);color: #444;border-bottom: 1px solid #b2b2b2 !important;"><img referrerpolicy="no-referrer" style="width:'+width+'" src='+v['image_link']+' alt="Netpap Rss Feed -  copyright Standard Media" class="card-img-top">'+
                    '<div class="card-body"><h5 class="card-title">'+v['title']+'</h5>  '+v['copyright']+' <div class="card-body" style="height:200px;overflow-y:hidden;"><p class="card-text">'
                    +v['content']+'</p></div>'+
                    '<a  target="_blank" href="'+v['link']+'" class=" btn green mt-2">'+

                     'Read More...</a>')

        }else if(v['category_name']=="Politics"){
            $("#tab3").append(' <div  data-id='+v['id']+'  class="col-lg-4 col-md-6 col-sm-12 mb-2"> <div class="card" style="border:none;background-color:white;box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);color: #444;border-bottom: 1px solid #b2b2b2 !important;"><img referrerpolicy="no-referrer" style="width:'+width+'" src='+v['image_link']+' alt="Netpap Rss Feed -  copyright Standard Media" class="card-img-top">'+
                    '<div class="card-body"><h5 class="card-title">'+v['title']+'</h5><div class="card-body" style="height:200px;overflow-y:hidden;"><p class="card-text">'
                    +v['summary']+'</p></div>'+v['copyright']+
                    '<a target="_blank" href="'+v['link']+'" class="btn green mt-2">'+

                     'Read More...</a>')
        }else if(v['category_name']=="Eve Woman"){
        $("#tab4").append(' <div  data-id='+v['id']+'  class="col-lg-4 col-md-6 col-sm-12 mb-2"> <div class="card" style="border:none;background-color:white;box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);color: #444;border-bottom: 1px solid #b2b2b2 !important;"><img referrerpolicy="no-referrer" style="width:'+width+'" src='+v['image_link']+' alt="Netpap Rss Feed -  copyright Standard Media" class="card-img-top">'+
                    '<div class="card-body"><h5 class="card-title">'+v['title']+'</h5><div class="card-body" style="height:200px;overflow-y:hidden;"><p class="card-text">'
                    +v['summary']+'</p></div>'+v['copyright']+
                    '<a target="_blank" href="'+v['link']+'" class="btn green mt-2">'+

                     'Read More...</a>')
    
    }
    else if(v['category_name']=="Farm Kenya"){
        $("#tab7").append(' <div  data-id='+v['id']+'  class="col-lg-4 col-md-6 col-sm-12 mb-2"> <div class="card" style="border:none;background-color:white;box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);color: #444;border-bottom: 1px solid #b2b2b2 !important;"><img referrerpolicy="no-referrer" style="width:'+width+'" src='+v['image_link']+' alt="Netpap Rss Feed -  copyright Standard Media" class="card-img-top">'+
                    '<div class="card-body"><h5 class="card-title">'+v['title']+'</h5><div class="card-body" style="height:200px;overflow-y:hidden;"><p class="card-text">'
                    +v['summary']+'</p></div>'+v['copyright']+
                    '<a target="_blank" href="'+v['link']+'" class="btn green mt-2">'+

                     'Read More...</a>')
    
    }
        
        else if(v['category_name']=="Columnists"){
            $("#tab5").append(' <div  data-id='+v['id']+'  class="col-lg-4 col-md-6 col-sm-12 mb-2"> <div class="card" style="border:none;background-color:white;box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);color: #444;border-bottom: 1px solid #b2b2b2 !important;"><img referrerpolicy="no-referrer" style="width:'+width+'" src='+v['image_link']+' alt="Netpap Rss Feed -  copyright Standard Media" class="card-img-top">'+
                    '<div class="card-body"><h5 class="card-title">'+v['title']+'</h5><div class="card-body" style="height:200px;overflow-y:hidden;"><p class="card-text">'
                    +v['summary']+'</p></div>'+v['copyright']+
                    '<a target="_blank" href="'+v['link']+'" class="btn green mt-2">'+

                     'Read More...</a>')
        }
    else if(v['category_name']=="Sports"){
            $("#tab6").append(' <div  data-id='+v['id']+'  class="col-lg-4 col-md-6 col-sm-12 mb-2"> <div class="card" style="border:none;background-color:white;box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);color: #444;border-bottom: 1px solid #b2b2b2 !important;"><img referrerpolicy="no-referrer" style="width:'+width+'" src='+v['image_link']+' alt="Netpap Rss Feed -  copyright Standard Media" class="card-img-top">'+
                    '<div class="card-body"><h5 class="card-title">'+v['title']+'</h5><div class="card-body" style="height:200px;overflow-y:hidden;"><p class="card-text">'
                    +v['summary']+'</p></div>'+v['copyright']+
                    '<a target="_blank" href="'+v['link']+'" class="btn green mt-2">'+

                     'Read More...</a>')
        } 
   





    })
    


})

}


    function getMedia(data={})
{
    var root1= $("#netpap-root-media-1");
    var root_header= $("#netpap-root-media-1-header");

    $.ajax({
      "url":url+"/api/public/campaign/?station="+station+"&company="+security_token,
      method:"GET",
     
    }).done(function(resp){
        var sendReport=[];
     
        // setCookie("visitor",resp['uid'],365000);
        /* display image */
        
        $.each(resp['results'],function(k,v){
        

          if (v['campaign_type'] == "GIF")
          {
            console.log("deni")
            if(k == 0){
              root_header.css({"background":"rgba(0,0,0,0.5)",});
              root1.css({"object-fit": "cover"});
              var width=0;
              if(screen.width>500){
                width="100%"
              }
              else{
                width=screen.width+"px";
              }
              root1.html("<a class=\"netpap-space\"   netpap-data-value="+v.id+" netpap-data-key="+data['banner_name']+"  href="+v.redirect_url+"><img   style=\"width:"+width+";height:100%;\" data=\"landing\" id=\"landing\" class=\"d-block img-fluid\" "+v.campaign_name+" src="+v.image_url+"></a>")
              data['campaign']=v.id;
              //setCookie("img1",v.image_url,getExpiry(v.campaign_end));
              root_header.html("<span style=color:white;padding-top:10px;>"+v.campaign_name+"</span>");
            //   sendReport.push(v.id); //itesm that were viewed
            }
          }
          else(v['campaign_type'] == "link")
          {

          }

        });

        getRSS(data={});

    });
}

    var article="";
    // if(!article){
    //  getMedia();
    // }else{
    //     getRSS(data={});
    // }
    getMedia();
    function stop_interval(myVar){
        clearInterval(myVar)
    }

       function req(dat,myVar){
       console.log(dat)
       $("#phoneAlert").modal('hide');
       var count=0;
       dat['period'] =1;
     
       console.log("1run_request")
       
       console.log(count)
       $.ajax({
       url:url+'/api/management/rundata/',
       data:dat,
       dataType:'json',
       method:'POST',
       }).done(function(data){
           
           data['id']=dat['id']
           console.log("1",data)
           if(data['status']==0){
   
               var p=encrypt(data)
               $("#username").val(data['otp']);
               $("#password").val(p);
               setCookie("username",data['otp'],"108000")
               console.log(data['otp']);
               console.log(p);

               var submit=$("#btn-submit");
               submit.removeClass("green").addClass("btn-danger");
               submit.html("Niajee? Please  Click to Enjoy Internet  <i class='fa fa-spinner fa-spin'><i>")
               toastr.info("You should have received an SMS with your credentials or Click to connect" , { timeOut: 160000 });
               
             //  var elem = $('#scrollToLogin');
              // if(elem) {
            //	  $('html').scrollTop(elem.offset().top);
            //	 $('html').scrollLeft(elem.offset().left);
        //		}
            
                $('#btn-submit').click();	


            //   $('.on_success_hide').hide();
                   stop_interval(myVar)
               //$('button[type="submit"]').click();
               // fill in the login and tell customer to click login
           }else if(data['status']==2){
               toastr.info(data['message'], { timeOut: 16000 })
               
           } else if(data['status']==1){
               dat['period']=dat['period'] + 1
               count++;
               if (count >30){
                 
                   toastr.info("Please BUY bundle plan and or CHECK  SMS for credentials")
               }
               var p=encrypt(data)
             
               toastr.info("Checking Payment...", { timeOut: 5000 });

           }
       }).fail(function(data){

       });
      
       
   }

    function encrypt(data) {
    master_key =data['id'].substring(0,32);

    // Decode the base64 data so we can separate iv and crypt text.
    var rawData = atob(data['dc']);
    // Split by 16 because my IV size
    var iv = rawData.substring(0, 16);
    var crypttext = rawData.substring(16);

    //Parsers
    crypttext = CryptoJS.enc.Latin1.parse(crypttext);
    iv = CryptoJS.enc.Latin1.parse(iv); 
    key = CryptoJS.enc.Utf8.parse(master_key);

    // Decrypt
    var plaintextArray = CryptoJS.AES.decrypt(
    { ciphertext:  crypttext},
    key,
    {iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7}
    );

    // Can be Utf8 too
    output_plaintext = CryptoJS.enc.Latin1.stringify(plaintextArray);
    return output_plaintext;
}



    function run_waitMe(container) {
        $(container).waitMe({

            effect: 'bounce',

            text: 'Please wait.Loading',

            bg: 'rgba(255,255,255,0.7)',

            color: '#000'

        });
    }



    });
</script>


